# 検索技術_期末レポート提出
21X3012　イ　ジョンアン

## データの説明
　データセットとして、TOPIX(東証株指環)とSAMSUNG Electronicsの2013/7/22から2023/7/20までの日付別終値を使用した。TOPIXの金額の単位はJPYで、SAMSUNG Electronicsの金額の単位はKRWである。

## 手法の説明
　手法としてLSTM(Long Short-Term Memory)を使用した。LSTMは循環ニューラルネットワーク(RN, Recurrent Neural Network)の一種で、シーケンスデータをモデリングし長期依存性を処理することに特化した人工ニューラルネットワークの一つだ。LSTMは前の時間段階の情報を記憶し、長期的な依存性を把握するのに役立つメモリセル構造を持っている。

## 手法を選んだ理由
　株価データは時間とともに順次的な特性を持っており、過去の価格動向が未来の価格変動に影響を及ぼす。LSTMはこのような長期依存性をキャプチャーし、以前の時間段階の情報を効果的に記憶して株価予測が可能であると考えられた。

## ダウンロード
　pythonのversionは3.10を使用した。
```
git clone https://github.com/bamtor1190/Serching-Technology.git
cd Serching-Technology
```
```
pip install -r requirements.txt
```

## 分析結果
### TOPIXの推定結果
<center><img src="/img/Figure_1.png" width="800" height="600"></center>

### SAMSUNG Electronicsの推定結果
<center><img src="/img/Figure_2.png" width="800" height="600"></center>

## 学習の説明
　今回使ったLSTMのレイアの説明をする。今回は50個のリューロンと4つのhidden layerでLSTMモデルを作り、正規化された株価を予測するための一個のニューロンを持った出力層を用いた。それぞれのhidden layerでは、Dropout layer(0.2)を追加して過学習を防いだ。最後に、Loss関数としてはMSE損失関数と確率的勾配降下法(全てのデータの中からランダムなデータ一つだけで勾配を求めてパラメータの更新していく作業をデータ数分行う方法)を使用した。確率的勾配降下法を使用した理由は局所解に囲まれてしまう可能性を最低限にするためである。学習用データセットは1500個、テスト用データセットは残ったデータを利用した(TOPIXの場合945個、SAMSUNGの場合957個)。epochsは100、batch sizeは32で学習を行った。

## 考察
　TOPIXの場合は正解のグラフと似たような形をしていたが、全体的な値は少し離れてしまった。SAMSUNGの場合は上昇することだけ当たってグラフの形も全体的な値も離れた形になってしまった。このことから、SAMSUNGの場合、過去のデータとは関係なく、外部的な要素が多く影響を及ぼしたと考えられた。また、TOPIXの場合、グラフの形をほぼ同じく推定できた部分で正解率の信頼性が高いと考えられた。また、TOPIXの場合は東証に上場している多くの銘柄を含んだ株価指数であるため、外部の影響に多く影響されないから信頼性の高い推定ができたと考えられる。
